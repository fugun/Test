<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"      
 "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

<mapper namespace="com.mapper.UserMapper"> 
	 
	<select  id="findByAccount"  parameterType="com.pojo.UserInfo" resultType="com.pojo.UserInfo">
		SELECT 
			 id,userId, loginName,aliasName, deleteStatus,status,password,lastDate,enaDate,email,session,updated,created				
		 FROM admin_info      
	      where   deleteStatus = 1 and status =1
			   <!--<trim suffixOverrides="and"> -->
			    <if test="loginName!=null">
					and loginName =#{loginName} 
				</if>
				<if test="password!=null">
					and  password =#{password} 
				</if>
				
				<!--  </trim> -->     		       
	</select >			
			<!-- 按修改时间倒叙 -->
	<select id="list" resultType="map" parameterType="com.pojo.UserInfo">
		SELECT 
			 id,userId, loginName,aliasName, deleteStatus,status,password,lastDate,enaDate,email,session,updated,created				
		 FROM admin_info 
		where deleteStatus=1
			 <if test="loginName !=null and loginName !=''">
					and loginName like concat('%',#{loginName},'%')
				</if>
				 <if test="null!= lastDate and lastDate !=''">
                and created >=#{lastDate}
            </if>
            <if test="null!= enaDate and enaDate !=''">
                and created &lt;= #{enaDate}
            </if> <!--  ORDER BY updated DESC-->
	</select> 		
	
	
	<select  id="findUserCaount"  parameterType="com.pojo.UserInfo" resultType="int">
		select count(1) FROM admin_info      
	      where   deleteStatus = 1 and status =1
			  
			    <if test="loginName !=null">
					and loginName =#{loginName} 
				</if>
					       
	</select >
	<update id="updateUser" parameterType="com.pojo.UserInfo">
		update
		admin_info set loginName = #{loginName} , email = #{email},updated=#{updated} where id = #{id}
	</update>	
	<update id="updateUserPassword" parameterType="com.pojo.UserInfo">
		update
		admin_info set updated=#{updated}
		<if test="password !=null and password !=''">
					, password = #{password} 
		</if>
		<if test="status !=null and status !=''">
					, status = #{status} 
		</if>
		  where id = #{id}
	</update>
	
	<insert id="addUser"  parameterType="com.pojo.UserInfo">	  
       		insert into admin_info (loginName,status,password,created,email,updated,deleteStatus)
       							
                   values (#{loginName},#{status},#{password},#{created},#{email},#{created},#{deleteStatus})
    </insert>
    
    <update id="deleteUser" parameterType="com.pojo.UserInfo">
		update
		admin_info set deleteStatus = #{deleteStatus},updated=#{updated} where id = #{id}
	</update>
	
	<select id="findPaymentaccountInfo" resultType="map" parameterType="com.pojo.Merchant">
		SELECT 
			 id,name, payInfo, createTime ,lastLoginTime,lastModiftyTime,isDel,des			
		 FROM merchant 
		where isDel=1
			 <if test="name !=null and name !=''">
					and name like concat('%',#{name},'%')
				</if>
				 <if test="null!= createTime and createTime !=''">
				 
                and createTime >=#{createTime}
            </if>
            <if test="null!= lastModiftyTime and lastModiftyTime !=''">
                and createTime &lt;= #{lastModiftyTime}
            </if>   ORDER BY createTime DESC
	</select> 
	
	<select  id="findPaymentaccountName"  parameterType="com.pojo.Merchant" resultType="com.pojo.Merchant">
		select id,name, payInfo, createTime ,lastLoginTime,lastModiftyTime,isDel,des			
		 FROM merchant     
	      where   isDel = 1 
			  
			    <if test="name !=null">
					and name =#{name} 
				</if>
				<if test="id !=null">
					and id =#{id} 
				</if>
					       
	</select >	
	<select  id="findPaymentaccountCount"  parameterType="com.pojo.Merchant" resultType="int">
		select count(1) FROM merchant      
	      where   isDel = 1 
			  
			    <if test="name !=null">
					and name =#{name} 
				</if>
					       
	</select >
	<insert id="addPaymerchant"  parameterType="com.pojo.Merchant">	  
       		insert into merchant (name, payInfo, createTime ,lastModiftyTime,isDel,des)
       							
                   values (#{name},#{payInfo},#{createTime},#{lastModiftyTime},#{isDel},#{des})
    </insert>
	
	 <update id="updatePaymentaccount" parameterType="com.pojo.Merchant">
		update
		merchant set name = #{name},payInfo=#{payInfo},des=#{des},lastModiftyTime = #{lastModiftyTime} where id = #{id}
	</update>	
	
	 	
	<update id="deletepayAccount" parameterType="com.pojo.Merchant">
		update
		merchant set isDel = #{isDel}, lastModiftyTime = #{lastModiftyTime} where id = #{id}
	</update>
	<update id="updateLoginTime" parameterType="com.pojo.UserInfo">
		update
		admin_info set  lastDate = #{lastDate} where id = #{id}
	</update>
		
		
	
</mapper>






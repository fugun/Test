<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title> 审核管理</title>
    <meta http-equiv="content-type" content="text/html; charset=GBK" />
    <meta name="keywords" content="审核管理" />
    <meta name="description" content="审核管理" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Cache-Control" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <link href="res/assets/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="res/assets/font-awesome/css/font-awesome.css" rel="stylesheet" />
    <link rel="stylesheet" href="res/assets/bootstrap-toggle-buttons/static/stylesheets/bootstrap-toggle-buttons.css" />
    <link href="res/css/style.css" rel="stylesheet" />
    <link href="res/css/chosen.css" rel="stylesheet" />
</head>

<body class="fixed-top">
    <div class="container-fluid container-fluid-back">
        <!-- BEGIN PAGE HEADER-->
        <div class="row-fluid">
            <div class="span12">
                <!-- BEGIN PAGE TITLE & BREADCRUMB-->
                <ul class="breadcrumb">
                    <li><a href="/right.jsp">首页</a> <span class="divider">/</span></li>
                    <li><a href="#">审核管理中心</a> <span class="divider">/</span></li>
                    <li class="active">审核管理</li>
                </ul>
                <!-- END PAGE TITLE & BREADCRUMB-->
            </div>
        </div>
        <!-- 开始:列表-->
        <div id="page-wraper">
        </div>
        <!-- huadongm-->
        <div class="Main">
            <div id="divMainTab" class="MainTab">
                <ul class="huadm">
                    <li id="li_1" class="selected" onClick="changeTab('1')"><i ></i>查询</li>
                    <li id="li_2" class="normal" onClick="changeTab('2')"><i ></i>审核</li>
                </ul>
            </div>
            <div id="div1" style="display :block" class="divContent">
                <!-- BEGIN BASIC PORTLET-->
                <div class="widget green" id="sms_channel_list">
                    <div class="widget-title">
                        <span class="tools">
                        <a href="javascript:;" class="icon-chevron-down"></a>
                        <a href="javascript:;" class="icon-remove"></a>
                    </span>
                    </div>
                    <div class="widget-body">
                        <!-- BEGIN FORM-->
                        <form action="#" class="form-horizontal1">
                            <div class="control-group sp_group">
                                <label class="sp-labe2">任务类型：</label>

                                <div class="controls sp-xiala">
                                    <select class="spanr6 chzn-select" id="sms_channelType" style="width:60px;" data-placeholder="" tabindex="1">
                                        <option value="" selected="selected">请选择</option>
                                        <option value="0">**</option>
                                        <option value="1">**</option>
                                        <option value="2">**</option>
                                    </select>
                                </div>                                
                                <label class="sp-labe2">根据广告主查找：</label>

                                <div class="controls controlsw">
                                    <input type="text" id="sms_port" class="spannr6 " />
                                </div>
                                <label class="sp-labe2">>根据关键字查找：</label>

                                <div class="controls controlsw">
                                    <input type="text" id="sms_cmd" class="spannr6" />
                                </div>
                                <label class="sp-labe2">状态：</label>

                                <div class="controls sp-xiala">
                                    <select class="spanr6 chzn-select" id="sms_status" style=" width:73px;" data-placeholder="" tabindex="1">
                                        <option value="-1" selected="selected">请选择</option>
                                        <option value="1">正常</option>
                                        <option value="0">禁用</option>
                                    </select>
                                </div>
                                <button class="btn btncha" onclick="query(1)" type="button"><i></i>查询</button>
                            </div>
                            <table id="accountTypeList" class="table table-striped table-hover table-bordered">
                                <thead>
                                    <tr>
                                       <th>标题</th>
                                        <th>任务描述</th>
                                        <th>任务日期</th>
                                        <th>添加时间</th>
                                        <th>修改时间</th>
                                        <th>状态</th>
                                        <th>添加人用户id</th>
                                        <th>任务类型</th>
                                        <th>状态</th> 
                                        <th>编辑</th>
                                    </tr>
                                </thead>
                                <tbody>

                                </tbody>
                            </table>
                            <div class="pagination fenye" id="sms_page_list">
                                <ul>
                                </ul>
                            </div>
                        </form>
                        <!-- END FORM-->
                    </div>
                </div>
                <!-- END BASIC PORTLET-->
            </div>
            <div id="div2" style="display:none;" class="divContent">
                 <!-- BEGIN BASIC PORTLET-->
                <div class="widget purple">
                        <div class="widget-title">
                            <span class="tools">
                        <a href="javascript:;" class="icon-chevron-down"></a>
                        <a href="javascript:;" class="icon-remove"></a>
                    </span>
                        </div>
                        <div class="widget-body">
                            <!-- BEGIN FORM-->
                            <div class="tongdao">
                                <div class="row-fluid">
                                    <div class="row-fluid">
                                        <div class="span6">
                                            <div class="control-group">
                                                <label class="control-label tongdaoming">任务标题:</label>

                                                <div class="controls controlsw">
                                                    <input id="Title" type="text" class="spann6 " />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="span6">
                                            <label class="sp-label">任务类型：</label>

                                            <div class="controls sp-xiala">
                                                <select class="span6 chzn-select" style="width:100px;" id="Type" data-placeholder="" tabindex="1">
                                                    <option value="" selected="selected">请选择</option>
                                                    <option value="0">朋友圈任务</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row-fluid">
                                        <div class="span6">
                                            <div class="control-group">
                                                <label class="control-label tongdaoming">普通会员：</label>

                                                <div class="controls controlsw">
                                                    <input id="Reward" type="text" class="spann6 " />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="span6">
                                            <div class="control-group groupge">
                                                <label class="control-label tongdaoming">黄金 VIP：</label>

                                                <div class="controls controlsw">
                                                    <input type="text" class="wenbenyu" id="RewardVip1" />
                                                </div>
                                                
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row-fluid">
                                       <div class="span6">
                                            <div class="control-group">
                                                <label class="control-label tongdaoming">钻石VIP：</label>

                                                <div class="controls controlsw">
                                                    <input id="RewardVip2" type="text" class="spann6 " />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="span6">
                                            <label class="sp-label">状态：</label>

                                            <div class="controls">
                                                <div id="sms-status-normal-toggle-button">
                                                    <input type="checkbox" id="Status" checked="checked" />
                                                </div>
                                            </div>
                                        </div>
                                             
                                    </div>                                 
                                   <!--  <div class="row-fluid">
                                        <div class="span6">
                                            <label class="sp-label">成本价格：</label>

                                            <div class="controls">
                                                <input type="text" class="span6" id="smsDayNumber" />
                                            </div>
                                        </div>
                                        <div class="span6">
                                            <label class="sp-label">下发佣金：</label>

                                            <div class="controls">
                                                <input type="text" class="span6" id="smsMonthlyNumber" />
                                            </div>
                                        </div>
                                    </div> -->
                                    <div class="row-fluid">
                                        <div class="span6">
                                            <label class="sp-label">任务说明/下发：</label>

                                            <div class="controls">
                                                <textarea id="Description" multiple="multiple" class="wenbxa"></textarea>
                                            </div>
                                        </div>
                                        <div class="span6">
                                            <div class="control-group groupge">
                                               <div id="showimg">
													<ul id="showui">
													</ul>
									
													<div id="showinput">
									
													</div>
												</div>
												<div class="upimg">
													<input type="file" id="upgteimg" value="" multiple />
												</div>
									
												<button class="btn yans1" id="submit">开始上传</button>
												 <input type="hidden" id="img_url" name="img" value="0"/>												
											</div>
 
                                        </div>              
                                    </div>
                                </div>

                            </div>
                            <div class="form-actions actionsbao">
                                <button type="submit" onclick="saveEdit()" class="btn yans1">编辑/保存</button>
                                <button type="button" class="btn" onclick="emptyEdit()">取消</button>
                            </div>
                            <!-- END FORM-->
                        </div>
                    </div>
                
                <!-- END BASIC PORTLET-->
            </div>
        </div>
        <!-- huadongm-->
        <!-- 结束:列表-->
        <!-- 开始:通道接入类型-->
        <div id="page-wraper">
        </div>
        <!-- 结束:通道接入类型-->
    </div>
    <script src="res/js/jquery-1.8.2.min.js"></script>
    <script type="text/javascript" src="res/js/jquery.nicescroll.js"></script>
    <script type="text/javascript" src="res/js/chosen.jquery.min.js"></script>
    <script type="text/javascript" src="res/assets/bootstrap-toggle-buttons/static/js/jquery.toggle.buttons.js"></script>
    <script src="res/js/common-scripts.js"></script>
    <script src="res/js/form-component.js"></script>
    <script src="res/js/layer.min.js" type="text/javascript"></script>
    <script src="res/js/onion_news_comment.js" type="text/javascript"></script>
    <script language="javascript" type="text/javascript">
        //<![CDATA[
        $(document).ready(function() {
            $('#sms-status-normal-toggle-button').toggleButtons({
                label: {
                    enabled: "正常",
                    disabled: "禁用"
                }
            });
           
        });
             
        function querySmsChannels(currentPage) {
            var sms_load = layer.load("正在努力加载短信通道中..");
            var sms_page_url = "query";
            $.post(
                sms_page_url, {
                    currentPage: currentPage,
                    providerId: $("#sms_channelType").val(),
                    spId: $("#sms_sp_complay").val(),
                    port: $("#sms_port").val(),
                    cmd: $("#sms_cmd").val(),
                    channelStatus: $("#sms_status").val()
                },
                function(data) {
                    layer.close(sms_load);
                    $("#sms_channel_list .widget-body table tbody").empty();
                    switch (data.code) {
                        case 1:
                            var smsChannels = data.data.content;
                            var tbodyHtml = "";
                            $.each(smsChannels, function(i, smsChannel) {
                                var status = "启用";
                                if (smsChannel.channelStatus == 0) {
                                    status = "禁用";
                                }
                                var isContentDim="";
                                if(smsChannel.isContentDim==1){
                                    isContentDim="指令模糊";
                                }else{
                                    isContentDim="精确";
                                }
                                tbodyHtml = tbodyHtml + "<tr class=\"\">";
                                tbodyHtml = tbodyHtml + "	<td>" + smsChannel.spInfo.adminName  + "</td>";
                                tbodyHtml = tbodyHtml + "	<td>" + smsChannel.channelName + "</td>";
                                tbodyHtml = tbodyHtml + "	<td>" + providerDic[smsChannel.provider] + "</td>";
                                tbodyHtml = tbodyHtml + "	<td>" + smsChannel.spInfo.companyName + "</td>";
                                tbodyHtml = tbodyHtml + "	<td class=\"center\">" + smsChannel.channelPort + "</td>";
                                tbodyHtml = tbodyHtml + "	<td class=\"daokuang\">" + smsChannel.channelContent + "</td>";
                                tbodyHtml = tbodyHtml+"<td>"+isContentDim+"</td>";
                                tbodyHtml = tbodyHtml + "	<td>" + smsChannel.channelPrice + "</td>";
                                tbodyHtml = tbodyHtml + "	<td>" + smsChannel.dividedPrice + "</td>";
                                if (smsChannel.channelStatus == 0) {
                                    tbodyHtml = tbodyHtml + "	<td><span class=\"label label-important label-mini\">禁用</span></td>";
                                } else {
                                    tbodyHtml = tbodyHtml + "    <td><span class=\"label label-import label-mini\">启用</span></td>";
                                }

                                tbodyHtml = tbodyHtml + "	<td><span  class=\"btn btncha\" type=\"button\" onclick=\"editSmsChannel(" + smsChannel.id + ")\"><i class=\"icon-share-alt\"></i>编辑</span></td>";
                                tbodyHtml = tbodyHtml + "</tr>";
                            });
                            $("#sms_channel_list .widget-body table tbody").html(tbodyHtml);
                            $("#sms_page_list").html(pageText(data.data, 'querySmsChannels'));
                            break;
                        case -1:
                            layer.alert("短信代码列表载入失败!请刷新重试", 3, !1);
                            break;
                        default:
                            break;
                    }
                }, "json"
            );
        }


        function smsClear() {
        	$("#smsChannelCmd").val("");
            $("#sms_channel_id").val("");
            $("#smsChannelComplay").val("0");
            $("#smsChannelName").val("");
            $("#smsChannelPort").val("");
            $("#smsChannelMoney").val("");
            $("#smsChannelDivided").val("");
            $("#smsChannelType").val(0);
            $("#smsChannelGateway").val("");
            $('#smsChannelStatus').prop('checked', true).change();
            $("#smsDayNumber").val("");
            $("#smsMonthlyNumber").val("");
            $("#smsSummary").val("");
            $('#smsCmdFunzzy').prop('checked', true).change();
            $(".chzn-select").trigger("liszt:updated");
        }


        function editSmsChannel(channel) {
            var channel_url = "/sp/channel/querySmsChannel";

            $.post(
                channel_url, {
                    channel: channel
                },
                function(data) {
                    var channel = data.smsChannel;
                    switch (data.code) {
                        case 1:
                            $("#sms_channel_id").val(channel.id);
                            $("#smsChannelComplay").val(channel.spInfo.id);
                            $("#smsChannelName").val(channel.channelName);
                            $("#smsChannelPort").val(channel.channelPort);
                            $("#smsChannelCmd").val(channel.channelContent);
                            $("#smsChannelMoney").val(channel.channelPrice);
                            $("#smsChannelDivided").val(channel.dividedPrice);
                            $("#smsChannelType").val(channel.channelType);
                            $("#smsChannelGateway").val(channel.provider);
                            if (channel.channelStatus == 1) {
                                $('#smsChannelStatus').prop('checked', true).change();
                            } else {
                                $('#smsChannelStatus').prop('checked', false).change();
                            }

                            if(channel.isContentDim==0){
                                $('#smsCmdFunzzy').prop('checked', true).change();
                            }else{
                                $('#smsCmdFunzzy').prop('checked', false).change();
                            }

                            $("#smsDayNumber").val(channel.dayLimitCount);
                            $("#smsMonthlyNumber").val(channel.monthLimitCount);
                            $("#smsSummary").val(channel.remark);
                            $(".chzn-select").trigger("liszt:updated");
                            break;
                        case 0:
                            layer.alert("系统错误!请刷新重试或者联系管理员.", 3, !1);
                            break;
                        default:
                            break;
                    }
                }, "json"
            );
        }
		
        //取消
        function emptyEditSmsChannel(){
        	
        	smsClear();
        	 $("#sms_channel_id").val("");
             $("#smsChannelComplay").val("");
             $("#smsChannelName").val("");
            $("#smsChannelPort").val("");
             $("#smsChannelCmd").val("");
             $("#smsChannelMoney").val("");
             $("#smsChannelDivided").val("");
            $("#smsChannelType").val("");
             $("#smsChannelGateway").val("");
            $("#smsChannelStatus").val("");
             $("#smsDayNumber").val("");
            $("#smsMonthlyNumber").val("");
            $("#smsSummary").val("");
           // var channelStatus = smsChannelStatus;
           $("#smsCmdFunzzy").val("");
        }
        
        function saveEditSmsChannel() {
            var channelId = $("#sms_channel_id").val();
            var smsChannelComplay = $("#smsChannelComplay").val();
            var smsChannelName = $("#smsChannelName").val();
            var smsChannelPort = $("#smsChannelPort").val();
            var smsChannelCmd = $("#smsChannelCmd").val();
            var smsChannelMoney = $("#smsChannelMoney").val();
            var smsChannelDivided = $("#smsChannelDivided").val();
            var smsChannelType = $("#smsChannelType").val();
            var smsChannelGateway = $("#smsChannelGateway").val();
            var smsChannelStatus = $("#smsChannelStatus").is(":checked") ? 1 : 0;
            var smsDayNumber = $("#smsDayNumber").val();
            var smsMonthlyNumber = $("#smsMonthlyNumber").val();
            var smsSummary = $("#smsSummary").val();
            var channelStatus = smsChannelStatus;
            var isContentDim=$("#smsCmdFunzzy").is(":checked")?0:1;
            if (smsChannelComplay == 0) {
                layer.alert("请选择通道所属SP公司!\n Error:通道所属SP公司不能为空!", 3, !1);
                return false;
            }
            if (smsChannelName.length < 1) {
                layer.alert("请填写通道名称!\n Error:通道名称不能为空!", 3, !1);
                return false;
            }
            if (smsChannelPort.length < 1) {
                layer.alert("请填写通道端口!\n Error:通道端口不能为空!", 3, !1);
                return false;
            }
            if (smsChannelCmd.length < 1) {
                layer.alert("请填写通道指令!\n Error:通道指令不能为空!", 3, !1);
                return false;
            }
            if (smsChannelMoney.length < 1) {
                layer.alert("请填写通道资费!\n Error:通道资费不能为空!", 3, !1);
                return false;
            }
            if(parseInt(smsChannelMoney)!=smsChannelMoney){
                layer.alert("请填写通道资费!\n Error:通道资费单位为分,请不要输入小数!", 3, !1);
                return false;
            }
            if (smsChannelDivided.length < 1) {
                layer.alert("请填写通道分成!\n Error:通道分成不能为空!", 3, !1);
                return false;
            }
            if(parseInt(smsChannelDivided)!=smsChannelDivided){
                layer.alert("请填写通道分成!\n Error:通道分成单位为分,请不要输入小数!", 3, !1);
                return false;
            }
            if (smsChannelType == 0) {
                layer.alert("请选择通道类型!\n Error:通道类型不能不选择!", 3, !1);
                return false;
            }
            if (smsChannelGateway == -1) {
                layer.alert("请选择网关运营商!\n Error:运营商不能不选择!", 3, !1);
                return false;
            }

            if (!$('#smsChannelStatus').is(":checked")) {
                channelStatus = 0;
            }

            var save_channel_url = "/channel/saveEditSmsChannel";
            $.post(
                save_channel_url, {
                    sms_channel: +channelId,
                    sms_complay: smsChannelComplay,
                    sms_channelName: smsChannelName,
                    sms_channelPort: smsChannelPort,
                    sms_channelCmd: smsChannelCmd,
                    sms_channelMoney: smsChannelMoney,
                    sms_channelDivied: smsChannelDivided,
                    sms_channelType: smsChannelType,
                    sms_channelGateway: smsChannelGateway,
                    sms_channelStatus: channelStatus,
                    sms_dayNumber: smsDayNumber,
                    sms_monthNumber: smsMonthlyNumber,
                    sms_channelIssued: '',
                    sms_summary: smsSummary,
                    is_content_dim:isContentDim
                },
                function(data) {
                    switch (data.code) {
                        case 1:
                            smsClear();
                            querySmsChannels(1);
                            layer.alert("保存通道成功!", 1, !1);
                            break;
                        case 2:
                            layer.alert("保存通道发生错误!请重试或联系管理员.", 3, !1);
                            break;
                        case 3:
                            layer.alert("保存通道失败!不是您的上家.", 3, !1);
                            break;
                        case 4:
                            layer.alert("保存通道失败!通道名称已存在.", 3, !1);
                            break;
                        case -1:
                            layer.alert("保存通道失败!端口指令已存在.", 3, !1);
                            break;
                        default:
                            break;
                    }
                }, "json"
            );
            return false;
        }

        //获取IVR通道分页
        function queryIvrChannels(currentPage) {
            var ivr_load = layer.load("正在努力加载IVR通道中..");
            var complay = $("#ivr_complay").val();
            var port = $("#ivr_port").val();
            var channelStatus = $("#ivr_channel_status").val();
            var url = "/sp/channel/queryIvrChannels";
            $.post(
                url, {
                    currentPage: currentPage,
                    spId: complay,
                    port: port,
                    channelStatus: channelStatus,
                },
                function(data) {
                    layer.close(ivr_load);
                    $("#ivr_channel_list .widget-body table tbody").empty();
                    switch (data.code) {
                        case 1:
                            var ivrChannels = data.data.content;
                            var tbodyHtml = "";
                            $.each(ivrChannels, function(i, ivrChannel) {
                                var status = "启用";
                                if (ivrChannel.channelStatus == 0) {
                                    status = "禁用";
                                }
                                tbodyHtml = tbodyHtml + "<tr class=\"\">";
                                tbodyHtml = tbodyHtml + "	<td>" + ivrChannel.channelName + "</td>";
                                tbodyHtml = tbodyHtml + "	<td>" + ivrChannel.spInfo.companyName + "</td>";
                                tbodyHtml = tbodyHtml + "	<td class=\"center\">" + ivrChannel.channelPort + "</td>";
                                tbodyHtml = tbodyHtml + "	<td>" + ivrChannel.channelPrice + "</td>";
                                tbodyHtml = tbodyHtml + "	<td>" + ivrChannel.dividedPrice + "</td>";
                                if (ivrChannel.channelStatus == 1) {
                                    tbodyHtml = tbodyHtml + "	<td><span class=\"label label-success label-mini\">" + status + "</span></td>";
                                } else {
                                    tbodyHtml = tbodyHtml + "	<td><span class=\"label label-important label-mini\">" + status + "</span></td>";
                                }

                                tbodyHtml = tbodyHtml + "	<td><button class=\"btn btncha\" type=\"button\" onclick=\"editIvrChannel(" + ivrChannel.id + ")\">编辑</button></td>";
                                tbodyHtml = tbodyHtml + "</tr>";
                            });
                            $("#ivr_channel_list .widget-body table tbody").html(tbodyHtml);
                            $("#ivr_page_list").html(pageText(data.data, 'queryIvrChannels'));
                            break;
                        case 1:
                            layer.alert("SP公司列表载入失败!请刷新重试", 3, !1);
                            break;
                        default:
                            break;
                    }
                }, "json"
            );
        }
		//取消 -
      function  emptySaveIvrChannel(){
    	  ivrClear();
    	   $("#ivrChannel").empty();
           $("#ivrChannelComplay").val("");
           $("#ivrChannelName").val("");
           $("#ivrChannelPort").val("");
           $("#ivrChannelMoney").val("");
           $("#ivrChannelDivided").val("");
           $("#ivrChannelGateway").val("");
           $("#ivrDayNumber").val("");
           $("#ivrMonthlyNumber").val("");
           $("#ivrSummary").val("");
      }
        //编辑=保存IVR通道
        function editSaveIvrChannel() {
            var ivrChannel = $("#ivrChannel").val();
            var ivrChannelComplay = $("#ivrChannelComplay").val();
            var ivrChannelName = $("#ivrChannelName").val();
            var ivrChannelPort = $("#ivrChannelPort").val();
            var ivrChannelMoney = $("#ivrChannelMoney").val();
            var ivrChannelDivided = $("#ivrChannelDivided").val();
            var ivrChannelGateway = $("#ivrChannelGateway").val();
            var ivrDayNumber = $("#ivrDayNumber").val();
            var ivrMonthlyNumber = $("#ivrMonthlyNumber").val();
            var ivrSummary = $("#ivrSummary").val();
            if (ivrChannelComplay == 0) {
                layer.alert("请选择通道所属SP公司!\n Error:通道所属SP公司不能为空!", 3, !1);
                return false;
            }

            if (ivrChannelName.length < 1) {
                layer.alert("请填写通道名称!\n Error:通道名称不能为空!", 3, !1);
                return false;
            }
            if (ivrChannelPort.length < 1) {
                layer.alert("请填写通道端口!\n Error:通道端口不能为空!", 3, !1);
                return false;
            }
            if (ivrChannelMoney.length < 1) {
                layer.alert("请填写通道资费!\n Error:通道资费不能为空!", 3, !1);
                return false;
            }
            if(parseInt(ivrChannelMoney)!=ivrChannelMoney){
                layer.alert("请填写通道资费!\n Error:通道资费单位为分,请不要输入小数!", 3, !1);
                return false;
            }
            if (ivrChannelDivided.length < 1) {
                layer.alert("请填写通道分成!\n Error:通道分成不能为空!", 3, !1);
                return false;
            }
            if(parseInt(ivrChannelDivided)!=ivrChannelDivided){
                layer.alert("请填写通道分成!\n Error:通道分成单位为分,请不要输入小数!", 3, !1);
                return false;
            }

            if (ivrChannelGateway == -1) {
                layer.alert("请选择网关类型!\n Error:运营商不能不选择!", 3, !1);
                return false;
            }
            var channelStatus = 1;
            if (!$('#ivrChannelStatus').is(":checked")) {
                channelStatus = 0;
            }

            var save_channel_url = "/sp/channel/saveEditIvrChannel";
            $.post(
                save_channel_url, {
                    ivr_channel: ivrChannel,
                    ivr_complay: ivrChannelComplay,
                    ivr_channelName: ivrChannelName,
                    ivr_channelPort: ivrChannelPort,
                    ivr_channelMoney: ivrChannelMoney,
                    ivr_channelDivied: ivrChannelDivided,
                    ivr_channelGateway: ivrChannelGateway,
                    ivr_channelStatus: channelStatus,
                    ivr_dayNumber: ivrDayNumber,
                    ivr_monthNumber: ivrMonthlyNumber,
                    ivr_summary: ivrSummary,
                },
                function(data) {
                    switch (data.code) {
                        case 1:
                            ivrClear();
                            queryIvrChannels(1);
                            layer.alert("保存IVR通道成功!", 1, !1);
                            break;
                        case 2:
                            layer.alert("保存通道发生错误!请重试或联系管理员.", 3, !1);
                            break;
                        case 3:
                            layer.alert("保存通道失败!不是您的上家.", 3, !1);
                            break;
                        case 4:
                            layer.alert("保存通道失败!通道名称已存在.", 3, !1);
                            break;
                        case 5:
                            layer.alert("保存通道失败!端口指令已存在.", 3, !1);
                            break;
                        default:
                            break;
                    }
                }, "json"
            );
            return false;

        }

        //IVR通道点击事件
        function editIvrChannel(channel) {
            var channel_url = "/sp/channel/queryIvrChannel";
            $.post(
                channel_url, {
                    channel: channel
                },
                function(data) {
                    var channel = data.data;
                    switch (data.code) {
                        case 1:
                            $("#ivrChannel").val(channel.id);
                            $("#ivrChannelComplay").val(channel.spInfo.id);
                            $("#ivrChannelName").val(channel.channelName);
                            $("#ivrChannelPort").val(channel.channelPort);

                            $("#ivrChannelMoney").val(channel.channelPrice);
                            $("#ivrChannelDivided").val(channel.dividedPrice);
                            $("#ivrChannelGateway").val(channel.providerId);
                            if (channel.channelStatus == 1) {
                                $('#ivrChannelStatus').prop('checked', true).change();
                            } else {
                                $('#ivrChannelStatus').prop('checked', false).change();
                            }
                            $("#ivrDayNumber").val(channel.dayLimitCount);
                            $("#ivrMonthlyNumber").val(channel.monthLimitCount);
                            $("#ivrSummary").val(channel.remark);

                            $(".chzn-select").trigger("liszt:updated");

                            //                            ivrClear();
                            queryIvrChannels(1);
                            break;
                        case 1:
                            layer.alert("系统错误!请刷新重试或者联系管理员.", 3, !1);
                            break;
                        default:
                            break;
                    }
                }, "json"
            );
        }



        function ivrClear() {
            $("#ivrChannel").val("");
            $("#ivrChannelComplay").val(0);
            $("#ivrChannelName").val("");
            $("#ivrChannelPort").val("");
            $("#ivrChannelMoney").val("");
            $("#ivrChannelDivided").val("");
            $("#ivrChannelGateway").val(0);
            $('#ivrChannelStatus').prop('checked', true).change();
            $("#ivrDayNumber").val("");
            $("#ivrMonthlyNumber").val("");
            $("#ivrSummary").val("");
            
            $(".chzn-select").trigger("liszt:updated");
        }


        //]]>
    </script>
</body>

</html>
